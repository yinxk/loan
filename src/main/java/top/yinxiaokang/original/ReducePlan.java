package top.yinxiaokang.original;

import top.yinxiaokang.others.ReducePlanEntity;

import java.math.BigDecimal;
import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.List;

/**
 * @author yinxk
 * @date 2018/7/6 14:11
 */
public class ReducePlan {

    public static void main(String[] args)  {
        long startTime = System.currentTimeMillis();
        Conn conn = new Conn();
        Connection connection = conn.getConnection();
        PreparedStatement preparedStatement = null;
        ResultSet resultSet = null;

        ReducePlan reducePlan = new ReducePlan();

        try {


            List<ReducePlanEntity> reducePlanEntityList = reducePlan.getLoan2(connection, preparedStatement, resultSet);
            BigDecimal bigDecimal = null;
            BigDecimal currentBX = null;
            BigDecimal overdueThisPeriodLX = null;
            BigDecimal bjje = null;
            int count = 0 ;
            for (ReducePlanEntity entity : reducePlanEntityList) {
                String id = entity.getId();
                BigDecimal dkll = entity.getDkll();
                BigDecimal llfdbl = entity.getLlfdbl();

                BigDecimal dkgbjhqs = entity.getDkgbjhqs();
                BigDecimal dkgbjhye = entity.getDkgbjhye();
                BigDecimal dqqc = entity.getDqqc();

                String dkhkfs = entity.getDkhkfs();
                if (dkgbjhqs.compareTo(BigDecimal.ZERO) > 0) {
                    bigDecimal = CommLoanAlgorithm.lendingRate(dkll, llfdbl);
                    currentBX = CommLoanAlgorithm.currentBX(dkgbjhye, Integer.parseInt(dkgbjhqs.toString()), dkhkfs, bigDecimal, Integer.parseInt(dqqc.toString())).setScale(2, BigDecimal.ROUND_HALF_UP);
                    overdueThisPeriodLX = CommLoanAlgorithm.overdueThisPeriodLX(dkgbjhye, Integer.parseInt(dqqc.toString()), dkhkfs, bigDecimal, Integer.parseInt(dkgbjhqs.toString())).setScale(2, BigDecimal.ROUND_HALF_UP);
                    bjje = currentBX.subtract(overdueThisPeriodLX);

                    int i = reducePlan.updateLoanAccountPlan(connection, currentBX,  bjje, overdueThisPeriodLX,id);
                    if (i > 0){
                        count ++;
                        System.out.println("更新了id为: " + id + " 的记录  ");
                    }
                }
            }

            System.out.println("总共更新的记录数:" + count);
            long endTime = System.currentTimeMillis();
            System.out.println("正常结束，时间："+(endTime - startTime) + " ms");
        }catch (Exception e){
            e.printStackTrace();
            conn.closeResource(connection,preparedStatement,resultSet);
        }finally {
            conn.closeResource(connection,preparedStatement,resultSet);
        }


    }


    public List<ReducePlanEntity> getLoan2(Connection connection,PreparedStatement preparedStatement,ResultSet resultSet) throws SQLException {
        String dkzhs = "'52001069403600000000528409',\n" +
                "    '52001069403600000000591551',\n" +
                "    '52001069008800000000637274',\n" +
                "    '52001069403600000000549976',\n" +
                "    '52001069403600000000542156',\n" +
                "    '52001069403600000000573183',\n" +
                "    '52001069403600000000563149',\n" +
                "    '52001069403600000000542011',\n" +
                "    '52001069403600000000565539',\n" +
                "    '52001069403600000000599624',\n" +
                "    '52001069403600000000573365',\n" +
                "    '52001069403600000000620991',\n" +
                "    '52001069403600000000551286',\n" +
                "    '52001069403600000000558718',\n" +
                "    '52001069403600000000611929',\n" +
                "    '52001069403600000000573417',\n" +
                "    '52001069403600000000607210',\n" +
                "    '52001069403600000000540552',\n" +
                "    '52001069403600000000607714',\n" +
                "    '52001069008800000000647975',\n" +
                "    '52001069403600000000529554',\n" +
                "    '52001069403600000000528410',\n" +
                "    '52001069403600000000586445',\n" +
                "    '52001069403600000000593637',\n" +
                "    '52001069403600000000529579',\n" +
                "    '52001069403600000000579657',\n" +
                "    '52001069403600000000529446',\n" +
                "    '52001069403600000000628013',\n" +
                "    '52001069403600000000580109',\n" +
                "    '52001069403600000000529090',\n" +
                "    '52001069403600000000565470',\n" +
                "    '52001069403600000000593759',\n" +
                "    '52001069403600000000592241',\n" +
                "    '52001069403600000000529204',\n" +
                "    '52001069403600000000586043',\n" +
                "    '52001069008800000000639755',\n" +
                "    '52001069403600000000558806',\n" +
                "    '52001069403600000000580093',\n" +
                "    '52001069403600000000565473',\n" +
                "    '52001069403600000000565537',\n" +
                "    '52001069403600000000621631',\n" +
                "    '52001069403600000000627936',\n" +
                "    '52001069403600000000521353',\n" +
                "    '52001069403600000000563381',\n" +
                "    '52001069403600000000529439',\n" +
                "    '52001069403600000000551278',\n" +
                "    '52001069008800000000652151',\n" +
                "    '52001069403600000000521964',\n" +
                "    '52001069403600000000558720',\n" +
                "    '52001069403600000000592051',\n" +
                "    '52001069403600000000608258',\n" +
                "    '52001069403600000000551277',\n" +
                "    '52001069403600000000529081',\n" +
                "    '52001069403600000000563199',\n" +
                "    '52001069008800000000635797',\n" +
                "    '52001069403600000000543139',\n" +
                "    '52001069008800000000635799',\n" +
                "    '52001069403600000000556737',\n" +
                "    '52001069403600000000592043',\n" +
                "    '52001069403600000000621638',\n" +
                "    '52001069403600000000563152',\n" +
                "    '52001069403600000000565480',\n" +
                "    '52001069403600000000593634',\n" +
                "    '52001069403600000000620986',\n" +
                "    '52001069403600000000552023',\n" +
                "    '52001069403600000000558733',\n" +
                "    '52001069403600000000627091',\n" +
                "    '52001069403600000000628019',\n" +
                "    '52001069403600000000627433',\n" +
                "    '52001069403600000000529203',\n" +
                "    '52001069403600000000621635',\n" +
                "    '52001069403600000000521228',\n" +
                "    '52001069403600000000612679',\n" +
                "    '52001069403600000000593742',\n" +
                "    '52001069008800000000634965',\n" +
                "    '52001069403600000000563771',\n" +
                "    '52001069403600000000628072',\n" +
                "    '52001069403600000000529559',\n" +
                "    '52001069403600000000591558',\n" +
                "    '52001069403600000000607200',\n" +
                "    '52001069403600000000564612',\n" +
                "    '52001069403600000000573404',\n" +
                "    '52001069403600000000593754',\n" +
                "    '52001069403600000000619779',\n" +
                "    '52001069403600000000528392',\n" +
                "    '52001069403600000000523643',\n" +
                "    '52001069008800000000652190',\n" +
                "    '52001069403600000000529435',\n" +
                "    '52001069403600000000543141',\n" +
                "    '52001069403600000000586336',\n" +
                "    '52001069403600000000611946',\n" +
                "    '52001069403600000000523653',\n" +
                "    '52001069403600000000556739',\n" +
                "    '52001069403600000000543657',\n" +
                "    '52001069403600000000598502',\n" +
                "    '52001069403600000000585787',\n" +
                "    '52001069403600000000529558',\n" +
                "    '52001069403600000000528406',\n" +
                "    '52001069403600000000573154',\n" +
                "    '52001069403600000000563779',\n" +
                "    '52001069403600000000555654',\n" +
                "    '52001069403600000000556795',\n" +
                "    '52001069403600000000585949',\n" +
                "    '52001069008800000000652194',\n" +
                "    '52001069008800000000648950',\n" +
                "    '52001069403600000000573368',\n" +
                "    '52001069403600000000580188',\n" +
                "    '52001069403600000000521247',\n" +
                "    '52001069008800000000634950',\n" +
                "    '52001069403600000000563534',\n" +
                "    '52001069403600000000592053',\n" +
                "    '52001069403600000000572722',\n" +
                "    '52001069403600000000593696',\n" +
                "    '52001069008800000000648033',\n" +
                "    '52001069403600000000563533',\n" +
                "    '52001069403600000000543157',\n" +
                "    '52001069403600000000627933',\n" +
                "    '52001069403600000000521341',\n" +
                "    '52001069403600000000621633',\n" +
                "    '52001069008800000000652205',\n" +
                "    '52001069403600000000580189',\n" +
                "    '52001069403600000000521961',\n" +
                "    '52001069403600000000563167',\n" +
                "    '52001069403600000000579146',\n" +
                "    '52001069403600000000621692',\n" +
                "    '52001069403600000000627245',\n" +
                "    '52001069403600000000558730',\n" +
                "    '52001069403600000000586334',\n" +
                "    '52001069403600000000543162',\n" +
                "    '52001069403600000000528412',\n" +
                "    '52001069403600000000586443',\n" +
                "    '52001069008800000000648931',\n" +
                "    '52001069403600000000558731',\n" +
                "    '52001069403600000000573287',\n" +
                "    '52001069403600000000628059',\n" +
                "    '52001069403600000000572884',\n" +
                "    '52001069008800000000639199',\n" +
                "    '52001069403600000000621619',\n" +
                "    '52001069403600000000563535',\n" +
                "    '52001069403600000000591547',\n" +
                "    '52001069403600000000542699',\n" +
                "    '52001069403600000000556418',\n" +
                "    '52001069403600000000521319',\n" +
                "    '52001069403600000000565468',\n" +
                "    '52001069403600000000593764',\n" +
                "    '52001069403600000000563517',\n" +
                "    '52001069403600000000604757',\n" +
                "    '52001069403600000000551288',\n" +
                "    '52001069403600000000580148',\n" +
                "    '52001069403600000000611344',\n" +
                "    '52001069403600000000621643',\n" +
                "    '52001069403600000000628022',\n" +
                "    '52001069403600000000585698',\n" +
                "    '52001069403600000000555649',\n" +
                "    '52001069403600000000555952',\n" +
                "    '52001069403600000000521314',\n" +
                "    '52001069403600000000540551',\n" +
                "    '52001069403600000000627238',\n" +
                "    '52001069403600000000527535',\n" +
                "    '52001069403600000000521329',\n" +
                "    '52001069403600000000541740',\n" +
                "    '52001069403600000000580187',\n" +
                "    '52001069403600000000621650',\n" +
                "    '52001069008800000000639193',\n" +
                "    '52001069403600000000563267',\n" +
                "    '52001069403600000000543135',\n" +
                "    '52001069403600000000627942',\n" +
                "    '52001069403600000000621592',\n" +
                "    '52001069403600000000543138',\n" +
                "    '52001069008800000000650473',\n" +
                "    '52001069403600000000558830',\n" +
                "    '52001069403600000000543133',\n" +
                "    '52001069403600000000527529',\n" +
                "    '52001069403600000000522739',\n" +
                "    '52001069403600000000585152',\n" +
                "    '52001069403600000000585966',\n" +
                "    '52001069403600000000607203',\n" +
                "    '52001069008800000000652211',\n" +
                "    '52001069403600000000528378',\n" +
                "    '52001069403600000000621659',\n" +
                "    '52001069403600000000586448',\n" +
                "    '52001069403600000000573406',\n" +
                "    '52001069403600000000593664',\n" +
                "    '52001069403600000000619783',\n" +
                "    '52001069403600000000521327',\n" +
                "    '52001069403600000000563497',\n" +
                "    '52001069403600000000573184',\n" +
                "    '52001069403600000000585965',\n" +
                "    '52001069403600000000619423',\n" +
                "    '52001069403600000000523648',\n" +
                "    '52001069403600000000523652',\n" +
                "    '52001069008800000000652184',\n" +
                "    '52001069008800000000635892',\n" +
                "    '52001069403600000000521325',\n" +
                "    '52001069403600000000571708',\n" +
                "    '52001069403600000000551276',\n" +
                "    '52001069403600000000627939',\n" +
                "    '52001069403600000000529442',\n" +
                "    '52001069403600000000551287',\n" +
                "    '52001069403600000000563319',\n" +
                "    '52001069403600000000541868',\n" +
                "    '52001069403600000000586460',\n" +
                "    '52001069403600000000630113',\n" +
                "    '52001069403600000000573153',\n" +
                "    '52001069403600000000608224',\n" +
                "    '52001069403600000000628055',\n" +
                "    '52001069403600000000584422',\n" +
                "    '52001069008800000000647977',\n" +
                "    '52001069403600000000593631',\n" +
                "    '52001069403600000000628082',\n" +
                "    '52001069403600000000569859',\n" +
                "    '52001069403600000000565475',\n" +
                "    '52001069403600000000612710',\n" +
                "    '52001069403600000000621580',\n" +
                "    '52001069403600000000578400',\n" +
                "    '52001069403600000000563370',\n" +
                "    '52001069403600000000528399',\n" +
                "    '52001069403600000000543655',\n" +
                "    '52001069403600000000573149',\n" +
                "    '52001069403600000000563359',\n" +
                "    '52001069008800000000637288',\n" +
                "    '52001069403600000000551280',\n" +
                "    '52001069008800000000635734',\n" +
                "    '52001069403600000000563142',\n" +
                "    '52001069403600000000573136',\n" +
                "    '52001069403600000000628883',\n" +
                "    '52001069403600000000529566',\n" +
                "    '52001069403600000000543167',\n" +
                "    '52001069403600000000627932',\n" +
                "    '52001069403600000000521227',\n" +
                "    '52001069403600000000593765',\n" +
                "    '52001069008800000000665431',\n" +
                "    '52001069403600000000586044',\n" +
                "    '52001069403600000000607692',\n" +
                "    '52001069403600000000521333',\n" +
                "    '52001069008800000000650367',\n" +
                "    '52001069403600000000598365',\n" +
                "    '52001069403600000000579148',\n" +
                "    '52001069403600000000606886',\n" +
                "    '52001069403600000000521335',\n" +
                "    '52001069403600000000570484',\n" +
                "    '52001069403600000000555975',\n" +
                "    '52001069008800000000638431',\n" +
                "    '52001069008800000000652191',\n" +
                "    '52001069403600000000543137',\n" +
                "    '52001069008800000000634956',\n" +
                "    '52001069403600000000592048',\n" +
                "    '52001069403600000000551282',\n" +
                "    '52001069403600000000563374',\n" +
                "    '52001069403600000000565479',\n" +
                "    '52001069403600000000573001',\n" +
                "    '52001069403600000000628014',\n" +
                "    '52001069008800000000639175',\n" +
                "    '52001069403600000000542155',\n" +
                "    '52001069403600000000606887',\n" +
                "    '52001069403600000000573408',\n" +
                "    '52001069403600000000612702',\n" +
                "    '52001069008800000000650373',\n" +
                "    '52001069008800000000648960',\n" +
                "    '52001069403600000000619342',\n" +
                "    '52001069403600000000593757',\n" +
                "    '52001069008800000000639475',\n" +
                "    '52001069403600000000612686',\n" +
                "    '52001069403600000000529193',\n" +
                "    '52001069403600000000584690',\n" +
                "    '52001069403600000000529434',\n" +
                "    '52001069403600000000528380',\n" +
                "    '52001069403600000000564112',\n" +
                "    '52001069008800000000639181',\n" +
                "    '52001069403600000000551279',\n" +
                "    '52001069403600000000628893',\n" +
                "    '52001069403600000000555616',\n" +
                "    '52001069403600000000619784',\n" +
                "    '52001069008800000000652208',\n" +
                "    '52001069008800000000639184',\n" +
                "    '52001069403600000000541744',\n" +
                "    '52001069403600000000540681',\n" +
                "    '52001069403600000000529555',\n" +
                "    '52001069008800000000652199',\n" +
                "    '52001069403600000000563202',\n" +
                "    '52001069008800000000635889',\n" +
                "    '52001069403600000000607123',\n" +
                "    '52001069008800000000638003',\n" +
                "    '52001069403600000000580094',\n" +
                "    '52001069403600000000592242',\n" +
                "    '52001069403600000000555607',\n" +
                "    '52001069403600000000611337',\n" +
                "    '52001069008800000000648965',\n" +
                "    '52001069403600000000593686',\n" +
                "    '52001069403600000000556794',\n" +
                "    '52001069403600000000563495',\n" +
                "    '52001069008800000000639786',\n" +
                "    '52001069403600000000591555',\n" +
                "    '52001069008800000000639205',\n" +
                "    '52001069008800000000638438',\n" +
                "    '52001069403600000000522742',\n" +
                "    '52001069403600000000521352',\n" +
                "    '52001069403600000000543136',\n" +
                "    '52001069403600000000621640',\n" +
                "    '52001069403600000000572991',\n" +
                "    '52001069403600000000563391',\n" +
                "    '52001069403600000000607206',\n" +
                "    '52001069403600000000627937',\n" +
                "    '52001069403600000000555603',\n" +
                "    '52001069403600000000564597',\n" +
                "    '52001069403600000000618759',\n" +
                "    '52001069403600000000628023',\n" +
                "    '52001069008800000000652185',\n" +
                "    '52001069403600000000558802',\n" +
                "    '52001069403600000000563514',\n" +
                "    '52001069403600000000542154',\n" +
                "    '52001069403600000000627935',\n" +
                "    '52001069403600000000522676',\n" +
                "    '52001069403600000000572850',\n" +
                "    '52001069403600000000608268',\n" +
                "    '52001069403600000000585697',\n" +
                "    '52001069403600000000578750',\n" +
                "    '52001069008800000000635752',\n" +
                "    '52001069403600000000572935',\n" +
                "    '52001069403600000000556411',\n" +
                "    '52001069403600000000541746',\n" +
                "    '52001069403600000000621642',\n" +
                "    '52001069403600000000629306',\n" +
                "    '52001069403600000000529431',\n" +
                "    '52001069403600000000543143',\n" +
                "    '52001069403600000000620161',\n" +
                "    '52001069403600000000522756',\n" +
                "    '52001069008800000000634958',\n" +
                "    '52001069403600000000627247',\n" +
                "    '52001069403600000000521944',\n" +
                "    '52001069403600000000593640',\n" +
                "    '52001069403600000000592049',\n" +
                "    '52001069403600000000597788',\n" +
                "    '52001069403600000000607694',\n" +
                "    '52001069403600000000627240',\n" +
                "    '52001069403600000000528413',\n" +
                "    '52001069403600000000573276',\n" +
                "    '52001069403600000000563288',\n" +
                "    '52001069008800000000639177',\n" +
                "    '52001069403600000000564123',\n" +
                "    '52001069403600000000529080',\n" +
                "    '52001069403600000000621565',\n" +
                "    '52001069403600000000551332',\n" +
                "    '52001069403600000000542016',\n" +
                "    '52001069403600000000584691',\n" +
                "    '52001069403600000000586335',\n" +
                "    '52001069403600000000629114',\n" +
                "    '52001069403600000000628018',\n" +
                "    '52001069008800000000639794',\n" +
                "    '52001069403600000000556425',\n" +
                "    '52001069403600000000551630',\n" +
                "    '52001069403600000000592046',\n" +
                "    '52001069403600000000541993',\n" +
                "    '52001069403600000000585946',\n" +
                "    '52001069008800000000665414',\n" +
                "    '52001069008800000000635828',\n" +
                "    '52001069008800000000650370',\n" +
                "    '52001069403600000000573418',\n" +
                "    '52001069403600000000593760',\n" +
                "    '52001069403600000000585728',\n" +
                "    '52001069403600000000627097',\n" +
                "    '52001069403600000000541989',\n" +
                "    '52001069403600000000521331',\n" +
                "    '52001069403600000000558728',\n" +
                "    '52001069403600000000630148',\n" +
                "    '52001069403600000000542719',\n" +
                "    '52001069403600000000578315',\n" +
                "    '52001069403600000000527517',\n" +
                "    '52001069403600000000563150',\n" +
                "    '52001069403600000000564195',\n" +
                "    '52001069403600000000593752',\n" +
                "    '52001069008800000000638471',\n" +
                "    '52001069403600000000578699',\n" +
                "    '52001069403600000000608233',\n" +
                "    '52001069403600000000528376',\n" +
                "    '52001069403600000000521231',\n" +
                "    '52001069403600000000558736',\n" +
                "    '52001069403600000000606876',\n" +
                "    '52001069403600000000522673',\n" +
                "    '52001069403600000000593627',\n" +
                "    '52001069403600000000541979',\n" +
                "    '52001069403600000000558723',\n" +
                "    '52001069403600000000541966',\n" +
                "    '52001069403600000000542734',\n" +
                "    '52001069403600000000573416',\n" +
                "    '52001069403600000000618762',\n" +
                "    '52001069403600000000549909',\n" +
                "    '52001069403600000000598514',\n" +
                "    '52001069403600000000563508',\n" +
                "    '52001069403600000000621587',\n" +
                "    '52001069403600000000529207',\n" +
                "    '52001069403600000000601166',\n" +
                "    '52001069403600000000580083',\n" +
                "    '52001069403600000000522670',\n" +
                "    '52001069403600000000558681',\n" +
                "    '52001069403600000000572879',\n" +
                "    '52001069403600000000529567',\n" +
                "    '52001069403600000000556793',\n" +
                "    '52001069403600000000555972',\n" +
                "    '52001069403600000000529432',\n" +
                "    '52001069403600000000593762',\n" +
                "    '52001069403600000000540696',\n" +
                "    '52001069403600000000592247',\n" +
                "    '52001069403600000000542035',\n" +
                "    '52001069403600000000578313',\n" +
                "    '52001069403600000000565477',\n" +
                "    '52001069403600000000579153',\n" +
                "    '52001069403600000000521952',\n" +
                "    '52001069403600000000523646',\n" +
                "    '52001069403600000000529552',\n" +
                "    '52001069403600000000592041',\n" +
                "    '52001069403600000000522730',\n" +
                "    '52001069403600000000558735',\n" +
                "    '52001069403600000000572888',\n" +
                "    '52001069403600000000619782',\n" +
                "    '52001069403600000000558714',\n" +
                "    '52001069403600000000621607',\n" +
                "    '52001069403600000000527531',\n" +
                "    '52001069403600000000629520',\n" +
                "    '52001069403600000000552016',\n" +
                "    '52001069403600000000611342',\n" +
                "    '52001069403600000000627234',\n" +
                "    '52001069403600000000584689',\n" +
                "    '52001069403600000000593630',\n" +
                "    '52001069403600000000555590',\n" +
                "    '52001069403600000000592235',\n" +
                "    '52001069403600000000521951',\n" +
                "    '52001069008800000000635735',\n" +
                "    '52001069403600000000555973',\n" +
                "    '52001069008800000000648935',\n" +
                "    '52001069403600000000521244',\n" +
                "    '52001069403600000000563501',\n" +
                "    '52001069403600000000543164',\n" +
                "    '52001069403600000000627248',\n" +
                "    '52001069403600000000618756',\n" +
                "    '52001069403600000000551289',\n" +
                "    '52001069403600000000592215',\n" +
                "    '52001069403600000000618563',\n" +
                "    '52001069403600000000528423',\n" +
                "    '52001069403600000000593694',\n" +
                "    '52001069403600000000563151',\n" +
                "    '52001069403600000000627239',\n" +
                "    '52001069008800000000648893',\n" +
                "    '52001069403600000000578323',\n" +
                "    '52001069403600000000619854',\n" +
                "    '52001069403600000000573187',\n" +
                "    '52001069403600000000564194',\n" +
                "    '52001069403600000000611341',\n" +
                "    '52001069403600000000619350',\n" +
                "    '52001069403600000000592923',\n" +
                "    '52001069403600000000628017',\n" +
                "    '52001069403600000000558845',\n" +
                "    '52001069403600000000549978',\n" +
                "    '52001069403600000000580096',\n" +
                "    '52001069403600000000523644',\n" +
                "    '52001069403600000000586450',\n" +
                "    '52001069403600000000563536',\n" +
                "    '52001069403600000000572875',\n" +
                "    '52001069403600000000555971',\n" +
                "    '52001069403600000000573419',\n" +
                "    '52001069403600000000593689',\n" +
                "    '52001069403600000000611360',\n" +
                "    '52001069403600000000527560',\n" +
                "    '52001069008800000000638435',\n" +
                "    '52001069403600000000551275',\n" +
                "    '52001069403600000000573275',\n" +
                "    '52001069403600000000601168',\n" +
                "    '52001069403600000000593766',\n" +
                "    '52001069403600000000584692',\n" +
                "    '52001069403600000000635730',\n" +
                "    '52001069008800000000639208',\n" +
                "    '52001069008800000000635732',\n" +
                "    '52001069008800000000647978',\n" +
                "    '52001069403600000000570120',\n" +
                "    '52001069403600000000585733',\n" +
                "    '52001069403600000000521350',\n" +
                "    '52001069403600000000565466',\n" +
                "    '52001069403600000000523656',\n" +
                "    '52001069403600000000529557',\n" +
                "    '52001069403600000000529200',\n" +
                "    '52001069008800000000654228',\n" +
                "    '52001069403600000000527514',\n" +
                "    '52001069403600000000586444',\n" +
                "    '52001069403600000000527525',\n" +
                "    '52001069008800000000637281',\n" +
                "    '52001069403600000000529449',\n" +
                "    '52001069403600000000563153',\n" +
                "    '52001069008800000000652581',\n" +
                "    '52001069403600000000523715',\n" +
                "    '52001069403600000000585940',\n" +
                "    '52001069403600000000558734',\n" +
                "    '52001069403600000000578701',\n" +
                "    '52001069403600000000586041',\n" +
                "    '52001069403600000000563889',\n" +
                "    '52001069403600000000529563',\n" +
                "    '52001069403600000000572845',\n" +
                "    '52001069403600000000585730',\n" +
                "    '52001069403600000000606885',\n" +
                "    '52001069403600000000629506',\n" +
                "    '52001069403600000000529565',\n" +
                "    '52001069403600000000555647',\n" +
                "    '52001069403600000000563147',\n" +
                "    '52001069403600000000593629',\n" +
                "    '52001069403600000000611927',\n" +
                "    '52001069403600000000521338',\n" +
                "    '52001069403600000000521312',\n" +
                "    '52001069403600000000580107',\n" +
                "    '52001069403600000000517326',\n" +
                "    '52001069403600000000542754',\n" +
                "    '52001069403600000000627231',\n" +
                "    '52001069008800000000665317',\n" +
                "    '52001069403600000000572716',\n" +
                "    '52001069403600000000573186',\n" +
                "    '52001069403600000000572889',\n" +
                "    '52001069403600000000627246',\n" +
                "    '52001069403600000000542701',\n" +
                "    '52001069403600000000543159',\n" +
                "    '52001069403600000000601167',\n" +
                "    '52001069403600000000573420',\n" +
                "    '52001069403600000000621646',\n" +
                "    '52001069403600000000622141',\n" +
                "    '52001069403600000000586446',\n" +
                "    '52001069403600000000607640',\n" +
                "    '52001069403600000000552024',\n" +
                "    '52001069403600000000585696',\n" +
                "    '52001069008800000000652572',\n" +
                "    '52001069403600000000552017',\n" +
                "    '52001069403600000000565471',\n" +
                "    '52001069403600000000563349',\n" +
                "    '52001069403600000000572871',\n" +
                "    '52001069008800000000635751',\n" +
                "    '52001069403600000000585732',\n" +
                "    '52001069403600000000593746',\n" +
                "    '52001069403600000000521953',\n" +
                "    '52001069403600000000529562',\n" +
                "    '52001069403600000000573271',\n" +
                "    '52001069008800000000652188',\n" +
                "    '52001069403600000000549979',\n" +
                "    '52001069403600000000628076',\n" +
                "    '52001069403600000000558813',\n" +
                "    '52001069403600000000585943',\n" +
                "    '52001069403600000000620990',\n" +
                "    '52001069403600000000621618',\n" +
                "    '52001069403600000000628064',\n" +
                "    '52001069403600000000592250',\n" +
                "    '52001069403600000000622145',\n" +
                "    '52001069403600000000621568',\n" +
                "    '52001069403600000000529564',\n" +
                "    '52001069403600000000572851',\n" +
                "    '52001069403600000000627934',\n" +
                "    '52001069403600000000558738',\n" +
                "    '52001069403600000000580111',\n" +
                "    '52001069403600000000619345',\n" +
                "    '52001069403600000000621945',\n" +
                "    '52001069403600000000521349',\n" +
                "    '52001069403600000000556736',\n" +
                "    '52001069403600000000522671',\n" +
                "    '52001069403600000000543140',\n" +
                "    '52001069403600000000528377',\n" +
                "    '52001069403600000000607121',\n" +
                "    '52001069403600000000628024',\n" +
                "    '52001069403600000000621551',\n" +
                "    '52001069403600000000529082',\n" +
                "    '52001069403600000000522736',\n" +
                "    '52001069403600000000521225',\n" +
                "    '52001069403600000000540723',\n" +
                "    '52001069403600000000521950',\n" +
                "    '52001069403600000000572719',\n" +
                "    '52001069403600000000570471',\n" +
                "    '52001069403600000000522726',\n" +
                "    '52001069403600000000620193',\n" +
                "    '52001069403600000000573164',\n" +
                "    '52001069403600000000555600',\n" +
                "    '52001069403600000000555974',\n" +
                "    '52001069403600000000584688',\n" +
                "    '52001069403600000000541975',\n" +
                "    '52001069403600000000621574',\n" +
                "    '52001069403600000000620877',\n" +
                "    '52001069403600000000619425',\n" +
                "    '52001069403600000000571710',\n" +
                "    '52001069403600000000629509',\n" +
                "    '52001069403600000000611334',\n" +
                "    '52001069403600000000522733',\n" +
                "    '52001069403600000000621653',\n" +
                "    '52001069403600000000573152',\n" +
                "    '52001069403600000000607209',\n" +
                "    '52001069403600000000573273',\n" +
                "    '52001069008800000000652183',\n" +
                "    '52001069403600000000521230',\n" +
                "    '52001069403600000000611351',\n" +
                "    '52001069403600000000619781',\n" +
                "    '52001069008800000000648895',\n" +
                "    '52001069403600000000585693',\n" +
                "    '52001069008800000000648963',\n" +
                "    '52001069403600000000543156',\n" +
                "    '52001069403600000000543144',\n" +
                "    '52001069403600000000555592',\n" +
                "    '52001069008800000000652206',\n" +
                "    '52001069403600000000541976',\n" +
                "    '52001069403600000000541977',\n" +
                "    '52001069403600000000521226',\n" +
                "    '52001069403600000000563776',\n" +
                "    '52001069403600000000628891',\n" +
                "    '52001069403600000000522743',\n" +
                "    '52001069403600000000586447',\n" +
                "    '52001069403600000000605119',\n" +
                "    '52001069403600000000606300',\n" +
                "    '52001069403600000000617583',\n" +
                "    '52001069403600000000605330',\n" +
                "    '52001069403600000000553870',\n" +
                "    '52001069403600000000606299',\n" +
                "    '52001069403600000000618131',\n" +
                "    '52001069403600000000618227',\n" +
                "    '52001069403600000000576590',\n" +
                "    '52001069403600000000618247',\n" +
                "    '52001069403600000000576998',\n" +
                "    '52001069403600000000605336',\n" +
                "    '52001069008800000000658407',\n" +
                "    '52001069008800000000633131',\n" +
                "    '52001069403600000000597102',\n" +
                "    '52001069403600000000605333',\n" +
                "    '52001069403600000000553934',\n" +
                "    '52001069008800000000647032',\n" +
                "    '52001069403600000000605948',\n" +
                "    '52001069403600000000618256',\n" +
                "    '52001069403600000000606032',\n" +
                "    '52001069403600000000576901',\n" +
                "    '52001069403600000000546567',\n" +
                "    '52001069403600000000606788',\n" +
                "    '52001069403600000000553978',\n" +
                "    '52001069403600000000617592',\n" +
                "    '52001069403600000000617349',\n" +
                "    '52001069403600000000520662',\n" +
                "    '52001069403600000000520481',\n" +
                "    '52001069403600000000520778',\n" +
                "    '52001069403600000000577036',\n" +
                "    '52001069403600000000598066',\n" +
                "    '52001069008800000000646803',\n" +
                "    '52001069403600000000540143',\n" +
                "    '52001069403600000000553879',\n" +
                "    '52001069008800000000618380',\n" +
                "    '52001069403600000000554086',\n" +
                "    '52001069403600000000576902',\n" +
                "    '52001069403600000000553901',\n" +
                "    '52001069403600000000590233',\n" +
                "    '52001069403600000000597754',\n" +
                "    '52001069403600000000520486',\n" +
                "    '52001069403600000000562800',\n" +
                "    '52001069403600000000576736',\n" +
                "    '52001069403600000000605334',\n" +
                "    '52001069403600000000606297',\n" +
                "    '52001069403600000000553892',\n" +
                "    '52001069403600000000577001',\n" +
                "    '52001069403600000000606036',\n" +
                "    '52001069403600000000606057',\n" +
                "    '52001069403600000000598070',\n" +
                "    '52001069403600000000540173',\n" +
                "    '52001069403600000000576903',\n" +
                "    '52001069403600000000554087',\n" +
                "    '52001069403600000000569264',\n" +
                "    '52001069403600000000540191',\n" +
                "    '52001069403600000000598064',\n" +
                "    '52001069403600000000605331',\n" +
                "    '52001069008800000000646800',\n" +
                "    '52001069403600000000520484',\n" +
                "    '52001069403600000000569949',\n" +
                "    '52001069008800000000646793',\n" +
                "    '52001069403600000000577020',\n" +
                "    '52001069403600000000606669',\n" +
                "    '52001069403600000000546957',\n" +
                "    '52001069403600000000540187',\n" +
                "    '52001069403600000000520477',\n" +
                "    '52001069403600000000618234',\n" +
                "    '52001069403600000000553932',\n" +
                "    '52001069403600000000540223',\n" +
                "    '52001069008800000000646757',\n" +
                "    '52001069403600000000553873',\n" +
                "    '52001069008800000000657992',\n" +
                "    '52001069403600000000597143',\n" +
                "    '52001069403600000000576686',\n" +
                "    '52001069403600000000597766',\n" +
                "    '52001069403600000000589502',\n" +
                "    '52001069403600000000617601',\n" +
                "    '52001069403600000000617597',\n" +
                "    '52001069403600000000553930',\n" +
                "    '52001069403600000000576727',\n" +
                "    '52001069403600000000577022',\n" +
                "    '52001069403600000000589572',\n" +
                "    '52001069403600000000540157',\n" +
                "    '52001069403600000000540183',\n" +
                "    '52001069403600000000576999',\n" +
                "    '52001069008800000000633109',\n" +
                "    '52001069403600000000520489',\n" +
                "    '52001069403600000000617612',\n" +
                "    '52001069403600000000605329',\n" +
                "    '52001069403600000000540160',\n" +
                "    '52001069008800000000646799',\n" +
                "    '52001069403600000000554103',\n" +
                "    '52001069403600000000618245',\n" +
                "    '52001069403600000000546926',\n" +
                "    '52001069403600000000553871',\n" +
                "    '52001069403600000000617595',\n" +
                "    '52001069403600000000617593',\n" +
                "    '52001069403600000000618249',\n" +
                "    '52001069403600000000577017',\n" +
                "    '52001069008800000000658410',\n" +
                "    '52001069403600000000540156',\n" +
                "    '52001069403600000000606246',\n" +
                "    '52001069403600000000597726',\n" +
                "    '52001069403600000000597725',\n" +
                "    '52001069403600000000617172',\n" +
                "    '52001069403600000000576740',\n" +
                "    '52001069403600000000554106',\n" +
                "    '52001069403600000000617619',\n" +
                "    '52001069403600000000553869',\n" +
                "    '52001069403600000000589364',\n" +
                "    '52001069403600000000554082',\n" +
                "    '52001069403600000000554100',\n" +
                "    '52001069403600000000596491',\n" +
                "    '52001069403600000000576733',\n" +
                "    '52001069008800000000647034',\n" +
                "    '52001069403600000000553942',\n" +
                "    '52001069403600000000617166',\n" +
                "    '52001069403600000000605430',\n" +
                "    '52001069403600000000605337',\n" +
                "    '52001069403600000000553860',\n" +
                "    '52001069403600000000606295',\n" +
                "    '52001069403600000000570072',\n" +
                "    '52001069403600000000605340',\n" +
                "    '52001069403600000000617611',\n" +
                "    '52001069403600000000589574',\n" +
                "    '52001069403600000000546955',\n" +
                "    '52001069008800000000618384',\n" +
                "    '52001069403600000000618265',\n" +
                "    '52001069403600000000617600',\n" +
                "    '52001069403600000000554114',\n" +
                "    '52001069403600000000617610',\n" +
                "    '52001069403600000000577010',\n" +
                "    '52001069403600000000617591',\n" +
                "    '52001069403600000000570091',\n" +
                "    '52001069403600000000553923',\n" +
                "    '52001069403600000000605324',\n" +
                "    '52001069403600000000554109',\n" +
                "    '52001069403600000000540229',\n" +
                "    '52001069403600000000554115',\n" +
                "    '52001069008800000000646749',\n" +
                "    '52001069403600000000618391',\n" +
                "    '52001069403600000000606047',\n" +
                "    '52001069403600000000605339',\n" +
                "    '52001069403600000000618231',\n" +
                "    '52001069403600000000577015',\n" +
                "    '52001069403600000000562792',\n" +
                "    '52001069008800000000618115',\n" +
                "    '52001069403600000000577025',\n" +
                "    '52001069403600000000553918',\n" +
                "    '52001069008800000000633104',\n" +
                "    '52001069403600000000546377',\n" +
                "    '52001069403600000000540162',\n" +
                "    '52001069403600000000606643',\n" +
                "    '52001069403600000000553851',\n" +
                "    '52001069008800000000633096',\n" +
                "    '52001069403600000000562634',\n" +
                "    '52001069403600000000577037',\n" +
                "    '52001069403600000000606050',\n" +
                "    '52001069403600000000597752',\n" +
                "    '52001069403600000000540155',\n" +
                "    '52001069403600000000540151',\n" +
                "    '52001069403600000000569398',\n" +
                "    '52001069403600000000605327',\n" +
                "    '52001069403600000000605335',\n" +
                "    '52001069403600000000605322',\n" +
                "    '52001069008800000000618375',\n" +
                "    '52001069403600000000589629',\n" +
                "    '52001069403600000000583003',\n" +
                "    '52001069403600000000589957',\n" +
                "    '52001069403600000000553875',\n" +
                "    '52001069403600000000562797',\n" +
                "    '52001069403600000000546956',\n" +
                "    '52001069403600000000589568',\n" +
                "    '52001069403600000000553938',\n" +
                "    '52001069403600000000520487',\n" +
                "    '52001069403600000000589501',\n" +
                "    '52001069403600000000589575',\n" +
                "    '52001069008800000000633090',\n" +
                "    '52001069403600000000553921',\n" +
                "    '52001069403600000000617588',\n" +
                "    '52001069403600000000582993',\n" +
                "    '52001069403600000000540132',\n" +
                "    '52001069403600000000618239',\n" +
                "    '52001069403600000000606045',\n" +
                "    '52001069403600000000589635',\n" +
                "    '52001069403600000000562676',\n" +
                "    '52001069403600000000520780',\n" +
                "    '52001069008800000000633097',\n" +
                "    '52001069403600000000576698',\n" +
                "    '52001069403600000000546954',\n" +
                "    '52001069403600000000520485',\n" +
                "    '52001069403600000000606055',\n" +
                "    '52001069008800000000633486',\n" +
                "    '52001069403600000000617606',\n" +
                "    '52001069403600000000617609',\n" +
                "    '52001069403600000000553907',\n" +
                "    '52001069403600000000605338',\n" +
                "    '52001069403600000000618386',\n" +
                "    '52001069403600000000553876',\n" +
                "    '52001069403600000000618113',\n" +
                "    '52001069403600000000546379',\n" +
                "    '52001069403600000000577002',\n" +
                "    '52001069403600000000617294',\n" +
                "    '52001069403600000000605325',\n" +
                "    '52001069403600000000606058',\n" +
                "    '52001069403600000000589423',\n" +
                "    '52001069403600000000605323',\n" +
                "    '52001069403600000000582995',\n" +
                "    '52001069403600000000553940',\n" +
                "    '52001069403600000000597090',\n" +
                "    '52001069403600000000553900',\n" +
                "    '52001069403600000000576899',\n" +
                "    '52001069403600000000597765',\n" +
                "    '52001069403600000000617167',\n" +
                "    '52001069403600000000596404',\n" +
                "    '52001069403600000000618223',\n" +
                "    '52001069403600000000617296',\n" +
                "    '52001069403600000000546958',\n" +
                "    '52001069403600000000617599',\n" +
                "    '52001069403600000000618273',\n" +
                "    '52001069403600000000589573',\n" +
                "    '52001069403600000000617077',\n" +
                "    '52001069403600000000535838',\n" +
                "    '52001069403600000000546392',\n" +
                "    '52001069403600000000589974',\n" +
                "    '52001069403600000000605421',\n" +
                "    '52001069403600000000553928',\n" +
                "    '52001069403600000000605328',\n" +
                "    '52001069403600000000546389',\n" +
                "    '52001069403600000000577563',\n" +
                "    '52001069403600000000540144',\n" +
                "    '52001069403600000000535195',\n" +
                "    '52001069403600000000540148',\n" +
                "    '52001069403600000000606291',\n" +
                "    '52001069403600000000520483',\n" +
                "    '52001069403600000000617615',\n" +
                "    '52001069403600000000589636',\n" +
                "    '52001069008800000000647035',\n" +
                "    '52001069403600000000554065',\n" +
                "    '52001069403600000000577007',\n" +
                "    '52001069403600000000540178',\n" +
                "    '52001069403600000000598068',\n" +
                "    '52001069403600000000540168',\n" +
                "    '52001069403600000000618251'";

        String selectSql = "SELECT\n" +
                "\taccount.id,\n" +
                "\taccount.dkll,\n" +
                "\taccount.llfdbl,\n" +
                "\tex.dkgbjhqs,\n" +
                "\tex.dkgbjhye,\n" +
                "\tex.dqqc,\n" +
                "\tpersonalLoan.dkhkfs\n" +
                "FROM\n" +
                "\tst_housing_personal_account account\n" +
                "JOIN c_loan_housing_personal_account_extension ex on account.extenstion =ex.id\n" +
                "JOIN st_housing_personal_loan personalLoan on account.contract = personalLoan.id\n" +
                "JOIN c_loan_housing_person_information_basic basic on basic.personalAccount = account.id " +
                "WHERE \n" +
                "\t basic.dkzhzt IN ('2', '3', '5')\n" +
                "AND basic.dkzh IN (\n" +dkzhs +
                ")\n ";

        preparedStatement = connection.prepareStatement(selectSql);
        resultSet = preparedStatement.executeQuery();
        List<ReducePlanEntity> reducePlanEntityList = new ArrayList<>();
        while (resultSet.next()) {
            ReducePlanEntity reducePlanEntity = new ReducePlanEntity();
            String id = resultSet.getString("id");
            BigDecimal dkll = resultSet.getBigDecimal("dkll");
            BigDecimal llfdbl = resultSet.getBigDecimal("llfdbl");
            BigDecimal dkgbjhqs = resultSet.getBigDecimal("dkgbjhqs");
            BigDecimal dkgbjhye = resultSet.getBigDecimal("dkgbjhye");
            BigDecimal dqqc = resultSet.getBigDecimal("dqqc");
            String dkhkfs= resultSet.getString("dkhkfs");
            reducePlanEntity.setId(id);
            reducePlanEntity.setDkll(dkll);
            reducePlanEntity.setLlfdbl(llfdbl);
            reducePlanEntity.setDkgbjhqs(dkgbjhqs);
            reducePlanEntity.setDkgbjhye(dkgbjhye);
            reducePlanEntity.setDqqc(dqqc);
            reducePlanEntity.setDkhkfs(dkhkfs);
            reducePlanEntityList.add(reducePlanEntity);
        }
        return reducePlanEntityList;
    }

    public int updateLoanAccountPlan(Connection connection,BigDecimal dqyhje,BigDecimal dqyhbj,BigDecimal dqyhlx,String id) throws SQLException {
        String sql = "update st_housing_personal_account set " +
                "DQYHJE = ? " +
                ", DQYHBJ = ?" +
                ", DQYHLX = ? " +
                ", DQJHHKJE = ?" +
                ", DQJHGHLX = ?" +
                ", DQJHGHBJ = ? " +
                ", updated_at = now() " +
                "where id = ?";

        PreparedStatement preparedStatement = connection.prepareStatement(sql);
        preparedStatement.setBigDecimal(1,dqyhje);
        preparedStatement.setBigDecimal(2, dqyhbj);
        preparedStatement.setBigDecimal(3, dqyhlx);
        preparedStatement.setBigDecimal(4,dqyhje);
        preparedStatement.setBigDecimal(5, dqyhlx);
        preparedStatement.setBigDecimal(6, dqyhbj);

        preparedStatement.setString(7, id);
        return preparedStatement.executeUpdate();
    }
}
